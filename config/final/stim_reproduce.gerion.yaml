branch_opts:
  loading:
    loaded_decomposition: "Original_Data"

  unification:
    # Allowed values are:
    #   "All":     only work in the unified space of all datasets, default
    #   "Datasets": only work in the spaces of individual datasets
    #   "Both":    ... do both
    unified_space: "All"

    # Run pipeline on individual sessions and combined sessions / just on combined session
    include_individual_sessions: False

    include_subsets: False


  generalize_from: "GN06.01-20#GN06.03-01#GN06.03-02#GN06.03-03#GN06.03-04#GN06.03-05#GN06.03-26#GN06.03-29"

    
    #GN06_untrained combined im shared_space von untrained
    #Gn06_untrained ind      im shared_space  
    #Gn06_untrained ind      im ind_space    

  #For now only session with hard trials
  datasets: 
    #Mice are considered novice within the first 3 month
    GN06:
      subjects:
        GN06:
          #- "2020-11-04_14-13-23"  #DataFrame df and trial_starts do not have matching length
          #- "2020-11-11_13-45-55" #empty after blaancing rightchoice
          #- "2020-11-12_15-52-36" #dataframe nan
          - "2020-11-13_15-45-13"
          - "2020-11-19_14-56-33"
          - "2020-11-20_14-41-44"
          - "2020-11-23_14-57-41"
          #- "2020-11-24_15-23-17" #empty after balancing rightchoice
          - "2020-11-30_13-17-29"
          - "2021-01-20_10-15-16"
          - "2021-01-21_09-54-09"
          - "2021-01-25_14-38-06"
          - "2021-02-01_10-35-56"
          - "2021-02-03_09-36-11"
          - "2021-02-04_09-38-35"
          - "2021-02-05_09-39-52"
          - "2021-02-08_09-43-26"
          - "2021-02-09_09-39-28"
          - "2021-02-15_09-38-47"
          - "2021-02-22_13-45-33"
          - "2021-02-23_14-17-47"
          - "2021-02-24_14-03-57"
          - "2021-02-25_13-50-28"
          - "2021-02-26_12-44-43"
          - "2021-03-01_13-57-39"
          - "2021-03-02_15-49-02"
          - "2021-03-03_14-02-06"
          - "2021-03-04_11-51-23"
          - "2021-03-05_14-55-49"

    GN08:
      subjects:
        GN08:
          - "2020-11-09_17-25-21"
          - "2020-11-19_15-54-26"
          - "2020-11-20_16-05-26"
          #- "2020-11-23_16-09-22"
          - "2020-11-24_16-56-52"
          - "2020-11-25_17-55-53"
          - "2020-11-26_16-01-49"
          - "2020-12-01_13-32-03"
          - "2021-01-27_16-58-24"
          #- "2021-01-29_14-02-44"
          - "2021-02-05_12-47-16"

    GN09:
      subjects:
        GN09:
          #- "2020-11-04_12-35-55" #DataFrame df and trial_starts do not have matching length
          #- "2020-11-05_12-23-45"
          - "2020-11-10_11-13-03"
          - "2020-11-24_11-40-03"
          #- "2020-11-25_12-52-04" ##empty after balancing rightChoice
          - "2021-02-03_15-03-57"
          - "2021-02-04_13-36-39"
          
    GN10:
      subjects:
        GN10:
          - "2020-11-10_13-57-57"
          - "2020-11-11_12-46-55"
          - "2020-11-13_13-18-47"
          - "2020-11-17_13-20-06"
          - "2020-11-20_12-30-34"
          - "2020-11-23_12-02-16"
          - "2020-11-24_12-17-19"
          #- "2020-11-25_12-01-59" # empty after blanacing rightchoice and left choice?
          - "2020-11-27_11-14-11"
          - "2020-11-30_17-06-32"
          - "2020-12-01_15-07-11"
          #- "2020-12-02_11-50-08" #empty after balancing leftchoice
          #- "2020-12-04_10-53-28" 
          - "2021-01-04_11-55-55"
          - "2021-01-19_13-43-34"
          - "2021-01-27_09-41-06"
          - "2021-02-03_13-34-09"
          - "2021-02-04_14-47-54"
          - "2021-02-05_15-52-46"
          - "2021-02-10_13-22-39"
          - "2021-02-22_10-54-29"
          - "2021-02-23_10-39-53"
          #- "2021-02-24_09-24-21" #empty after balancing leftChoice
          - "2021-02-25_10-29-35"
          - "2021-03-05_10-36-28"
          - "2021-03-09_09-25-36"
          - "2021-03-12_10-47-53"
          - "2021-03-15_10-34-55"
          - "2021-03-16_09-38-17"
          - "2021-03-18_09-54-42"
          - "2021-03-24_15-22-52"

              
          
          #- GN08_novice
          #- GN09_novice
          

    





  conditions:
  
    default:
      phase: all
      n_targets: all
      n_distractors: none #largerzero
      auto_reward: no
      both_spouts: yes
      

    #Stimulus Decoder
    L-V:
      sides: left
      modalities: visual

    L-T:
      sides: left
      modalities: tactile

    L-VT:
      sides: left
      modalities: vistact

    R-V:
      sides: right
      modalities: visual
    
    R-T:
      sides: right
      modalities: tactile
    R-VT:
      sides: right
      modalities: vistact
  

    #Correct:
    #  group:
    #    - LR-LS
    #    - RR-RS
    #Incorrect:
    #  group:
    #    - LR-RS
    #    - RR-LS
  
  parcellations:
    SVD:
    #  n_components: 
    #    - 299
    #LocaNMF:
    anatomical:
    
  selected_trials:
    All:


  features:

    #spot-activity: #Full Timeseries for each trial
    #  window: [2]
      #phase: 
        #- all
        #- pretrial
        #- stimulus
        #- response
        
        #- stim1
        #- inter_stim
        #- stim2
        #- delay
        #- response

    #full-activity: #Full Timeseries for each trial
      #phase: 
        #- all
        #- pretrial
        #- stimulus
        #- response

    mean-activity: #Mean Activity over trial
      phase: 
        #- all
        #- pretrial
        - stimulus
        #- stim1
        #- inter_stim
        #- stim2
        - delay
        - response
        #- posttrial

    #dFC:
    #  phase:
      #  - pretrial
    #    - stimulus
      #  - response

    #full-dFC:
    #  phase:
    #    - stimulus
    #  - response
    
    #FC:
    #  phase:
    #    - all
    #    - pretrial
    #    - stimulus
        #- delay
    #    - response
        #- posttrial

    #spot-activity-dFC:
    #  phase:
      #  - pretrial
    #    - stimulus
      #  - response

    #full-activity-dFC:
    #  phase:
    #    - stimulus
      #- response
    
    #mean-activity-FC:
    #  phase:
    #    - stimulus
    #    - all
    #    - pretrial


    ##moup:
    ##  phase:
    ##    - stimulus

    #raw:
    #  max_components : [64]

    #mean:
    #  window: [1]

      #optional:
      #  window: [1] #TODO currently needs to be in an array (should support int aswell)

    #covariance:
      #max_components : [64]
    #moup:
    #  timelags: [1] #,2,3]
      #optional:
      #  thresh:
      #    - 0.5
    #  max_components : [64]

    #autocorrelation:
    #  timelags: [[1]] #,[1]]
    #  phase:
    #    - stimulus



  decoders:
    default:
      reps: [10]
    MLR:
      C: [0.05,0.1,0.5,1]
    LDA:
      
    #MLRshuffle:

static_params:
  parcellations:
    anatomical:
    ICA:
    LocaNMF:
      minrank: 2
      maxrank: 8
      min_pixels: 400
      loc_thresh: 300
      r2_thresh: 0.99
      nonnegative_temporal: False


  selected_trials:
    All:

  features:
    mean:

  decoders:
    MLR:
    1NN:
    LDA:
    RF:

paths:
  parcellations:
    ICA: {}
    anatomical:
      atlas: resources/meta/anatomical.mat
    LocaNMF:
      atlas: resources/meta/anatomical.mat

different_config_inputs: 1

limit_memory: 0

loglevel: INFO

export_type: 'npy'



# Defines trial phases for Gerions Experimental Setup
trial_conditions:
  sides:
    column: target_side_left
    conds:
      left:   1
      right:  0
  modalities:
    column: modality
    conds:
      visual:   0
      tactile:  1
      vistact:  2
  responses:
    column: response_left
    conds:
      left: 1
      right: 0
      no: -1
  n_targets:
    column: n_targets
    conds:
      all: 6
  n_distractors:
    column: n_distractors
    conds:
      none: 0
      largerzero: [1,2]
  auto_reward:
    column: auto_reward
    conds:
      no: 0
      yes: 1
  both_spouts:
    column: both_spouts
    conds:
      no: 0
      yes: 1

phase_conditions:
  pretrial:
    start: 0
    stop:  30
  stimulus:
    start:  30
    stop:   75
  delay:
    start: 75
    stop: 82
  response:
    start: 82
    stop: 113
  posttrial:
    start: 113
    stop: 134
  all:
    start: 0
    stop: 134
